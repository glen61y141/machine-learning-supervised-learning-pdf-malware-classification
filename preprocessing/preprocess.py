import pandas as pd
from sklearn.preprocessing import MinMaxScaler

df_ben = pd.read_csv('data/contagio-ben.csv')
df_mal = pd.read_csv('data/contagio-mal.csv')

df = pd.concat([df_ben, df_mal])

for feature_name in ['class', 'box_other_only', 'pdfid_mismatch']:
    df.loc[df.loc[:, feature_name] == False, feature_name] = -1
    df.loc[df.loc[:, feature_name] == True, feature_name] = 1

label = df['class']
df.drop(['class', 'filename'], axis=1, inplace=True)

norm = MinMaxScaler().fit_transform(df)
df_norm = pd.DataFrame(norm, columns=df.columns)

df_norm.insert(loc=0, column='class', value=label.tolist())
df_norm.to_csv('data/norm.csv')